<div id='recentBuildsContent' class='contentContainer contentColumnNarrowHalf contentUpperLeft'>
  <div id='recentBuildsTitle' class='contentTitle'>
    <h3>Recent Builds</h3>
  </div>
  <table class='table table-striped table-hover'>
    <thead>
      <th class='result'>Result</th>
      <th class='package'>Package</th>
      <th class='dist'>Dist</th>
      <th class='buildTime'><i class="icon-time"></i></th>
      <th id = 'trendHeader'class='trend'><i class="icon-time"></i> Trend by Dist (All Time)</th>
    </thead>
    <tbody>
    <% @stats[:latest].each do |row| %>
      <tr>
        <% if row.success == true
             circleColor = 'limegreen'
           else
             circleColor = 'red'
           end
        %>
        <td>
          <svg id='resultCell'  xmlns="http://www.w3.org/2000/svg" version="1.1">
            <defs>
              <filter id="drop-shadow">
                <feGaussianBlur in="SourceGraphic" stdDeviation="1" />
              </filter>
            </defs>
            <circle class='resultCircle' r='5' cx='20' cy='8' filter="url(#drop-shadow)"
              fill=<%= "#{circleColor}" %>>
          </svg>
        </td>
        <td><%= row.package_name %></td>
        <td><%= row.dist %></td>
        <td><%= "#{row.jenkins_build_time.round(0)} sec" %></td>
        <td id="<%= "sparkline#{row.id}" %>">
          <%= time_array = Array.new
              @trends["#{row.package_name}-#{row.dist}"].each do |row|
                time_array << row.jenkins_build_time
              end
              puts time_array.inspect
          %>
          <script type='text/javascript'>
            createRecentSparkline( <%= time_array %>, <%= "sparkline#{row.id}" %> )
          </script>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>

<div id='teamContent' class='contentContainer contentColumnNarrowHalf contentLowerLeft'></div>

<div id='summaryContent' class='contentContainer contentColumnWideHalf contentUpperRight'>

  <div id='summaryContentTitle' class='contentTitle'>
    <h3>Metric Summaries</h3>
  </div>

  <div id='summaryBuildNumber'>
    <div id='summaryBuildNumberTitle' class='contentTitle'>
      <h4>Builds over Time</h4>
    </div>
    <div id='summaryBuildNumberContent'>
      <div class='yAxisLabel'>Builds</div>
    </div>
  </div>

  <div id='summaryShipped'>
    <div id='summaryShippedTitle' class='contentTitle'>
      <h4>Shipped Packages</h4>
    </div>
    <div id='summaryShippedContent'>
      <div class='yAxisLabel'>Shipped</div>
    </div>
  </div>

  <div id='summaryFreqPackages'>
    <div id='summaryFreqPackagesTitle' class='contentTitle'>
      <h4>Frequently Built Packages</h4>
    </div>
    <div id='summaryFreqPackagesContent'>
    </div>
  </div>

  <div id='summaryMisc'>
    <div id='summaryMiscTitle' class='contentTitle'>
      <h4>Miscellaneous Stats</h4>
    </div>
    <div id='summaryMiscContent'>
    </div>
  </div>
</div>

<div id='buildHostContent' class='contentContainer contentColumnWideHalf contentLowerRight'>

  <div id='buildHostContentTitle' class='contentTitle'>
    <h3>Metrics by Package Type</h3>
  </div>

  <div id='typeBuildNumber'>
    <div id='typeBuildNumberTitle' class='contentTitle'>
      <h4>Number of Builds</h4>
    </div>
    <div id='typeBuildNumberContent'>
      <div class='yAxisLabel'>Builds</div>
      <script type='text/javascript'>
        createDistNumbersGraph(<%= [@stats[:deb].to_json, @stats[:rpm].to_json, @stats[:gem].to_json, @stats[:dmg].to_json] %>)
      </script>
    </div>
  </div>

  <div id='typeBuildSpeed'>
    <div id='typeBuildSpeedTitle' class='contentTitle'>
      <h4>Average Build Speed</h4>
    </div>
    <div id='typeBuildSpeedContent'>
      <div class='yAxisLabel'>Seconds</div>
      <script type='text/javascript'>
        createDistAvgSpeedGraph(<%= [@stats[:deb].to_json, @stats[:rpm].to_json, @stats[:gem].to_json, @stats[:dmg].to_json] %>)
      </script>
    </div>
  </div>

  <div id='typeBuildHost'>
    <div id='typeBuildHostTitle' class='contentTitle'>
      <h4>Most Used Build Hosts by Type</h4>
    </div>
    <div id='typeBuildHostContent'>
      <table id='freqHostTable' class='table table-striped table-hover'>
        <thead>
          <th class='freqHostTableHead'>Type</th>
          <th class='freqHostTableHead'>Host</th>
          <th class='freqHostTableHead'>Builds</th>
          <th class='freqHostTableHead'>Percentage of Builds</th>
        </thead>
        <tbody>
          <% [@stats[:deb], @stats[:rpm], @stats[:gem], @stats[:dmg]].each do |pkgtype| %>
            <tr>
              <td><strong><%= pkgtype[:type] %></strong></td>
              <td><%= pkgtype[:freqHost][0] %></td>
              <td><%= pkgtype[:freqHost][1] %></td>
              <td><%= "#{pkgtype[:freqHostPercent]}%" %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
